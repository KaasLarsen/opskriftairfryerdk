<!doctype html>
<html lang="da">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Seneste Opskrifter – Opskrift-Airfryer.dk</title>
<meta name="description" content="Alle de nyeste airfryer opskrifter samlet ét sted. Nemt, sprødt og hurtigt – med tider og temperaturer." />
<link rel="icon" href="/img/favicon.ico" />
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7373148222153531" crossorigin="anonymous"></script>
<style>
*,*::before,*::after{box-sizing:border-box}html,body{height:100%}
body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:#0f172a;background:#fff;line-height:1.65}
a{text-decoration:none;color:inherit}img{max-width:100%;display:block}
:root{--max:1200px;--pad:16px;--muted:#475569;--line:#e2e8f0;--soft:#f8fafc;--accent:#0ea5e9;--shadow:0 8px 22px rgba(2,8,23,.06)}
.container{max-width:var(--max);margin:0 auto;padding:0 var(--pad)}
.hero{padding:22px 0 12px}
.kicker{font-size:12px;color:var(--muted);text-transform:uppercase;letter-spacing:.06em}
h1{font-size:clamp(26px,3vw,38px);line-height:1.2;margin:6px 0 8px}
.lead{margin:0;color:var(--muted)}
.section{margin:24px 0}
.section-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.section-head h2{font-size:22px;margin:0}
.grid{display:grid;gap:16px}
.grid-3{grid-template-columns:repeat(3,1fr)}
@media(max-width:900px){.grid-3{grid-template-columns:1fr 1fr}}
@media(max-width:560px){.grid-3{grid-template-columns:1fr}}
.card{border:1px solid var(--line);border-radius:14px;background:#fff;box-shadow:var(--shadow);overflow:hidden;display:block;transition:transform .06s ease}
.card:hover{transform:translateY(-2px)}
.thumb-icon{aspect-ratio:16/9;display:grid;place-items:center;background:linear-gradient(180deg,#f8fafc,#fff)}
.thumb-icon svg{width:54px;height:54px;color:#0ea5e9}
.card-body{padding:12px 14px}
.card-body h3{font-size:15px;line-height:1.35;margin:0}
.meta{font-size:13px;color:var(--muted);margin-top:4px}
.adsbygoogle[data-ad-status="unfilled"]{display:none !important}
/* Filter-bar */
.filterbar{display:grid;grid-template-columns:1fr 240px;gap:10px;
  border:1px solid var(--line);border-radius:14px;box-shadow:var(--shadow);
  background:#fff0f5;padding:12px 14px;margin:8px 0 18px}
@media(max-width:700px){.filterbar{grid-template-columns:1fr}}
.filterbar input,.filterbar select{
  padding:10px 12px;border:1px solid var(--line);border-radius:10px;font-size:15px;width:100%
}
.filter-meta{font-size:13px;color:var(--muted);margin-top:6px}
.clear-link{font-size:13px;color:var(--muted);text-decoration:underline;cursor:pointer}
</style>
</head>
<body>

<div data-include="/partials/icons.html"></div>
<div data-include="/partials/header.html"></div>

<main class="container">
  <section class="hero">
    <span class="kicker">Overblik</span>
    <h1>Seneste Opskrifter</h1>
    <p class="lead">De nyeste airfryer opskrifter – altid med tider og temperaturer.</p>
  </section>

  <div style="margin:8px 0 18px">
    <ins class="adsbygoogle" style="display:block"
         data-ad-client="ca-pub-7373148222153531"
         data-ad-slot="1234567890"
         data-ad-format="auto"
         data-full-width-responsive="true"></ins>
    <script>(adsbygoogle=window.adsbygoogle||[]).push({});</script>
  </div>

  <!-- FILTER-BAR -->
  <section class="section" aria-label="Filtrér opskrifter">
    <div class="filterbar">
      <input id="q" type="search" placeholder="🔍 Søg i titel eller kategori…" />
      <select id="cat"><option value="">Alle kategorier</option></select>
      <div class="filter-meta" id="filter-meta"></div>
    </div>
  </section>

  <!-- LISTE -->
  <section class="section">
    <div class="section-head">
      <h2 id="list-title">Alle</h2>
      <a id="clear" class="clear-link" style="display:none">Nulstil filtre</a>
    </div>
    <div id="alle-grid" class="grid grid-3">
      <p class="meta">Indlæser opskrifter…</p>
    </div>
  </section>
</main>

<div data-include="/partials/footer.html"></div>
<script src="/assets/include.js?v=4"></script>

<!-- DATA -->
<script src="/assets/recipes.js?v=20"></script>

<script>
(function(){
  const $q = document.getElementById('q');
  const $cat = document.getElementById('cat');
  const $meta = document.getElementById('filter-meta');
  const $grid = document.getElementById('alle-grid');
  const $title = document.getElementById('list-title');
  const $clear = document.getElementById('clear');

  const iconSvg = id => '<div class="thumb-icon"><svg><use href="#'+(id||'star')+'"></use></svg></div>';
  const card = r => [
    '<a class="card" href="/opskrifter/'+r.slug+'.html">',
      iconSvg(r.icon),
      '<div class="card-body"><h3>'+r.title+'</h3>',
        r.meta ? '<p class="meta">'+r.meta+'</p>' : '',
      '</div>',
    '</a>'
  ].join('');

  function norm(s){
    return (s||'').toLowerCase()
      .replace(/æ/g,'ae').replace(/ø/g,'oe').replace(/å/g,'aa')
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim();
  }

  function applyFilters(list, q, cat){
    const nq = norm(q), ncat = norm(cat);
    let out = list;
    if (nq){
      out = out.filter(r =>
        norm(r.title).includes(nq) ||
        norm(r.slug).includes(nq) ||
        (r.categories||[]).some(c => norm(c).includes(nq))
      );
    }
    if (ncat){
      out = out.filter(r => (r.categories||[]).some(c => norm(c) === ncat));
    }
    return out;
  }

  function populateCats(list){
    const set = new Set();
    list.forEach(r => (r.categories||[]).forEach(c => c && set.add(c)));
    const cats = Array.from(set).sort((a,b)=> a.localeCompare(b,'da'));
    $cat.innerHTML = '<option value="">Alle kategorier</option>' + cats.map(c=>'<option>'+c+'</option>').join('');
  }

  function render(list){
    $grid.innerHTML = (list && list.length) ? list.map(card).join('') : '<p class="meta">Ingen opskrifter matcher dine filtre.</p>';
  }

  function updateTitle(q, cat, count){
    const parts = [];
    if (cat) parts.push(cat);
    if (q) parts.push('“'+q+'”');
    $title.textContent = parts.length ? parts.join(' · ') + ' ('+count+')' : 'Alle';
    $clear.style.display = (q || cat) ? 'inline' : 'none';
    $meta.textContent = count ? (count + ' opskrift' + (count>1?'er':'')) : '';
  }

  function readParams(){
    const p = new URLSearchParams(location.search);
    return { soeg: p.get('soeg') || '', kategori: p.get('kategori') || '' };
  }
  function writeParams(q, cat){
    const p = new URLSearchParams();
    if (q) p.set('soeg', q);
    if (cat) p.set('kategori', cat);
    const newUrl = location.pathname + (p.toString()? '?'+p.toString() : '');
    history.replaceState(null, '', newUrl);
  }

  let t; const debounced = fn => { clearTimeout(t); t = setTimeout(fn, 180); };

  function boot(all){
    populateCats(all);
    const { soeg, kategori } = readParams();
    if (soeg) $q.value = soeg;
    if (kategori) $cat.value = kategori;

    const first = applyFilters(all, soeg, kategori);
    render(first); updateTitle(soeg, kategori, first.length);

    $q.addEventListener('input', ()=> debounced(()=>{
      const q = $q.value.trim(); const c = $cat.value.trim();
      const res = applyFilters(all, q, c); render(res); updateTitle(q,c,res.length); writeParams(q,c);
    }));
    $cat.addEventListener('change', ()=>{
      const q = $q.value.trim(); const c = $cat.value.trim();
      const res = applyFilters(all, q, c); render(res); updateTitle(q,c,res.length); writeParams(q,c);
    });
    $clear.addEventListener('click', ()=>{
      $q.value=''; $cat.value=''; render(all); updateTitle('', '', all.length); writeParams('', '');
    });
  }

  if (window.AFO && AFO.ready && typeof AFO.ready.then === 'function'){
    AFO.ready.then(()=> boot(AFO.getAll()))
             .catch(()=> $grid.innerHTML = '<p class="meta">Kunne ikke hente opskrifter.</p>');
  } else {
    window.addEventListener('load', ()=> boot(window.RECIPES||[]));
  }
})();
</script>
</body>
</html>
